CREATE OR REPLACE FUNCTION avgState ( state tuple<int,double>, val float ) CALLED ON NULL INPUT RETURNS tuple<int,double> LANGUAGE java AS 'if (val !=null) { state.setInt(0, state.getInt(0)+1); state.setDouble(1, state.getDouble(1) + val.doubleValue()); } return state;';